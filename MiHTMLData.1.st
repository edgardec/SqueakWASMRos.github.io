'From SqueakRosCore4dot5 of 20 May 2013 [latest update: #12630] on 12 June 2019 at 5:36:14 am'!Object subclass: #MiHTMLData	instanceVariableNames: 'title body date color links indexValue css ip pass author tags uploads'	classVariableNames: ''	poolDictionaries: ''	category: 'HV-Divagaciones'!!MiHTMLData methodsFor: 'testing' stamp: 'edc 3/10/2011 09:32'!isNewPage^ self body isNil! !!MiHTMLData methodsFor: 'testing' stamp: 'edc 8/16/2010 08:35'!isProtected	^ (self pass = '') not! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 5/15/2015 05:19'!author	"Answer the value of author"	^ author ifNil:[author := 'SqueakWiki ']! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 5/26/2011 07:23'!author: anObject	"Set the value of author"	author := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/4/2010 16:44'!body	"Answer the value of body"	^ body! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 5/8/2014 16:42'!body: aString aString ifEmpty:[^self].		body := self shouldCreateaPage: aString! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/12/2010 09:47'!color	"Answer the value of color"	^ color! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/12/2010 09:47'!color: anObject	"Set the value of color"	color := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 8/5/2016 18:49'!css	"Answer the value of css"	^ css ! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/19/2010 06:26'!css: anObject	"Set the value of css"	css := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/4/2010 16:44'!date	"Answer the value of date"	^ date! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 12/7/2012 07:41'!date: anObject	"Set the value of date"	date := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/17/2010 08:33'!indexValue	"Answer the value of indexValue"	^ indexValue! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/17/2010 08:33'!indexValue: anObject	"Set the value of indexValue"	indexValue := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/19/2010 11:00'!ip	"Answer the value of ip"	^ ip ifNil:['localhost']! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/19/2010 10:59'!ip: anObject	"Set the value of ip"	ip := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 5/21/2013 08:41'!links	^ links		ifNil: ['<br>']! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/12/2010 09:47'!links: anObject	"Set the value of links"	links := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 8/16/2010 08:29'!pass	"Answer the value of pass"	^ pass		ifNil: [pass := '']! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 8/13/2010 10:52'!pass: anObject	"Set the value of pass"	pass := anObject! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 2/13/2017 09:56'!tags^tags ifNil:[tags := OrderedCollection new]! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 1/4/2010 16:44'!title	"Answer the value of title"	^ title! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 3/21/2018 10:23'!title: fName 	"Set the value of title"	|correctedName |			correctedName := String streamContents:[:s|								fName do:[:c|									  c  isAlphaNumericOrSpace ifTrue:[s nextPut: c]]]. 								title := correctedName withBlanksTrimmed! !!MiHTMLData methodsFor: 'accessing' stamp: 'edc 3/9/2017 12:20'!uploads	^ uploads		ifNil: [uploads := Dictionary new]! !!MiHTMLData methodsFor: 'formatting' stamp: 'edc 10/27/2016 09:01'!createaPage: aString 	| index aMiHTMLData |	index := DivagacionesIndex default.	aMiHTMLData := MiHTMLData template.	aMiHTMLData author: Divagaciones user.	aMiHTMLData title: aString.	aMiHTMLData css: Divagaciones currentPage css.	index at: aString put: OrderedCollection new.	(index at: aString)		add: aMiHTMLData! !!MiHTMLData methodsFor: 'formatting' stamp: 'edc 6/4/2015 12:44'!short| s r |s := String new.body ifNil: [^'Lost in translation'].r := ReadStream		on:self body .1 to: 3 do: [:ea|s := s ,r nextLine].s := s .' <p class="meta"> <h1>.   .   . </h1> </p>'.^ s! !!MiHTMLData methodsFor: 'formatting' stamp: 'edc 12/30/2017 07:37'!shouldCreateaPage: stream 	| link pos1 pos2 shouldCreate htmLink antes despues index |	index := DivagacionesIndex default.	pos1 := stream indexOf: $*.	pos1 = 0		ifTrue: [^ stream].	pos1 < stream size		ifTrue: [pos2 := stream indexOf: $* startingAt: pos1 + 2.			pos2 = 0				ifTrue: [^ stream]].	pos2 > pos1		ifTrue: [link := stream copyFrom: pos1 + 1 to: pos2 - 1.			link isEmptyOrNil				ifTrue: [^ stream].			link := (link splitBy: '>') last.			shouldCreate := (shouldCreate := index								at: link								ifAbsent: [])						ifNil: [true]						ifNotNil: [false].								shouldCreate				ifTrue: [self createaPage: link.					htmLink := '<a class="internal" href="/renderMe:' , link , '">' , link , '</a>'.					antes := stream copyFrom: 1 to: pos1 - 1.					despues := stream copyFrom: pos2 + 1 to: stream size.					^ antes , htmLink , despues].			link isNil				ifFalse: [					shouldCreate						ifFalse: [htmLink := '<a class="internal" href="/renderMe:' , link , '">' , link , '</a>'].					antes := stream copyFrom: 1 to: pos1 - 1.					despues := stream copyFrom: pos2 + 1 to: stream size.					^ antes , htmLink , despues]].	^ stream! !!MiHTMLData methodsFor: 'objects from disk' stamp: 'edc 12/27/2017 08:32'!export	| oldFolder newFolder year dir|	oldFolder := FileDirectory default.	newFolder := FileDirectory on: FileDirectory default pathName , '/objFiles'.	FileDirectory setDefaultDirectory: newFolder pathName.	year := self date year asString.	dir := self createDirIfnotExists: year.	FileDirectory setDefaultDirectory: dir pathName.	self saveOnFileNamed: self date yyyymmdd onlyDigits , self title.	FileDirectory setDefaultDirectory: oldFolder pathName! !!MiHTMLData methodsFor: 'objects from disk' stamp: 'edc 11/2/2014 08:38'!import	Divagaciones addNewPage: self! !!MiHTMLData methodsFor: 'objects from disk' stamp: 'edc 5/9/2014 08:17'!importas: view		Divagaciones addNewPage: self as: view! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!MiHTMLData class	instanceVariableNames: 'current'!!MiHTMLData class methodsFor: 'as yet unclassified' stamp: 'edc 1/28/2013 07:22'!template" MiHTMLData template "	| instance |	instance := self new.	instance := MiHTMLData new.	instance title: 'Sin titulo'.	instance color: 'green'.	instance date: DateAndTime now asTimeStamp.		instance body: String new.	instance links: OrderedCollection new.	^ instance! !!MiHTMLData class methodsFor: 'as yet unclassified' stamp: 'edc 9/11/2014 09:26'!template: view" MiHTMLData template "	| instance |	instance := self new.	instance := MiHTMLData new.	instance title: 'Sin titulo'.	instance color: 'green'.	instance date: DateAndTime now asTimeStamp.	instance css: view.	instance body: String new.	instance links: OrderedCollection new.	^ instance! !